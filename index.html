<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Our Wedding</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital,wght@0,400;0,500;0,600;0,700;1,400&family=Raleway:wght@300;400;500;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Georgia', serif;
      background: #000;
      min-height: 100vh;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 20px;
      padding-top: calc(58vh - 50px);
      position: relative;
      overflow: hidden;
    }
    
    /* Mobile: allow scrolling so keyboard doesn't cover input (password page only) */
    @media (max-width: 768px) {
      body:not(.content-visible) {
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
        min-height: 150vh; /* Extra height so page can scroll up when keyboard opens */
        padding-bottom: 50vh;
      }
    }
    
    /* Video background for password page */
    .video-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      z-index: -1;
      overflow: hidden;
      opacity: 1;
      transition: opacity 2s ease-out;
    }
    
    .video-background video {
      width: 100%;
      height: 100vh;
      object-fit: cover;
      object-position: center;
    }
    
    /* Mobile: video scrolls with content */
    @media (max-width: 768px) {
      .video-background {
        position: absolute;
      }
    }
    
    /* Dark overlay for better text readability */
    .video-background::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      pointer-events: none;
    }
    
    /* Fallback gradient if video doesn't load */
    body.no-video {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    /* Fade out video on main content page */
    body.content-visible .video-background {
      opacity: 0;
      transition: opacity 2s ease-out;
      pointer-events: none;
    }
    
    body.content-visible {
      display: block !important;
      background: #faf9f7;
      align-items: flex-start;
      padding-top: 0 !important;
      padding: 0 !important;
      min-height: 100vh !important;
      padding-bottom: 0 !important;
      overflow-y: auto !important;
      overflow-x: hidden !important;
      height: auto !important;
    }
    
    .container {
      background: transparent;
      border-radius: 0;
      max-width: 100%;
      width: 100%;
      overflow: hidden;
      position: relative;
      z-index: 1;
    }
    
    /* No background or box for main content */
    .container.content-showing {
      background: transparent;
      box-shadow: none;
      height: 100vh;
      max-width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .password-page {
      padding: 60px 40px;
      text-align: center;
      position: relative;
      z-index: 1;
    }
    
    .password-page h1 {
      color: #fff;
      margin-bottom: 20px;
      font-size: 2.5em;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }
    
    .password-page p {
      color: #fff;
      margin-bottom: 30px;
      font-size: 1.1em;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
    }
    
    .password-input {
      width: 100%;
      max-width: 300px;
      padding: 15px 20px;
      font-size: 16px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      border: 1px solid rgba(68, 68, 68, 0.6);
      border-radius: 10px;
      transition: border-color 0.3s, color 0.3s;
      margin: 0;
      height: 50px;
      background: transparent;
      color: #fff;
      text-align: center;
    }
    
    .password-input::placeholder {
      color: rgba(200, 200, 200, 0.9);
      font-style: italic;
      text-align: center;
    }
    
    .password-input:focus {
      outline: none;
      border-color: rgba(68, 68, 68, 0.8);
    }
    
    .password-input-container {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 15px;
      position: relative;
    }
    
    /* Ensure input stays visible on mobile when keyboard opens */
    @media (max-width: 600px) {
      .password-page {
        padding: 20px 20px;
        min-height: auto;
      }
      
      .password-input-container {
        margin-top: 10px;
      }
      
      /* When input is focused, ensure it's visible */
      .password-input:focus {
        position: relative;
        z-index: 10;
      }
    }
    
    .password-input.granted {
      color: #4ade80;
      border-color: #4ade80;
    }
    
    .btn {
      background: rgba(68, 68, 68, 0.7);
      color: white;
      border: none;
      padding: 0;
      font-size: 24px;
      border-radius: 10px;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
      font-weight: bold;
      width: 50px;
      height: 50px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      line-height: 1;
      backdrop-filter: blur(10px);
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(68, 68, 68, 0.4);
      background: rgba(68, 68, 68, 0.85);
    }
    
    .btn:active {
      transform: translateY(0);
    }
    
    .error-message {
      color: #ff6b6b;
      margin-top: 15px;
      font-size: 14px;
      min-height: 20px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
      font-weight: 500;
    }
    
    /* ========== MAIN CONTENT STYLES ========== */
    .main-content {
      display: none;
      width: 100%;
      min-height: 100vh;
      background: #faf9f7;
      opacity: 0;
      transition: opacity 2s ease-in;
      font-family: 'Raleway', sans-serif;
      overflow-y: auto;
      overflow-x: hidden;
    }
    
    /* Desktop fixed header container */
    .desktop-fixed-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: #faf9f7;
      z-index: 1001;
      border-bottom: 1px solid #eee;
    }
    
    /* Site Header */
    .site-header {
      text-align: center;
      padding: 40px 20px 20px;
      background: #faf9f7;
    }
    
    .site-title {
      font-family: 'Bodoni Moda', serif;
      font-size: 4em;
      font-weight: 400;
      color: #1a1a1a;
      letter-spacing: 2px;
      margin-bottom: 15px;
    }
    
    .site-title .ampersand {
      font-style: normal;
    }
    
    .site-date {
      font-family: 'Raleway', sans-serif;
      font-size: 1.1em;
      font-weight: 400;
      color: #333;
      letter-spacing: 3px;
      text-transform: uppercase;
    }
    
    .site-date-mobile {
      display: none;
    }
    
    @media (max-width: 768px) {
      .site-date {
        display: none;
      }
      
      .site-date-mobile {
        display: block;
        font-family: 'Raleway', sans-serif;
        font-size: 1em;
        font-weight: 400;
        color: #333;
        letter-spacing: 2px;
        text-transform: uppercase;
        text-align: center;
      }
      
      .site-date-mobile .date-line,
      .site-date-mobile .location-line {
        display: block;
      }
      
      .site-date-mobile .date-divider {
        display: block;
        width: 40px;
        height: 2px;
        background: #F5A623;
        margin: 12px auto;
      }
    }
    
    /* Mobile-only elements hidden on desktop */
    .mobile-only {
      display: none;
    }
    
    /* Desktop Navigation */
    .site-nav {
      display: flex;
      justify-content: center;
      gap: 40px;
      padding: 20px;
      background: #faf9f7;
    }
    
    .site-nav a {
      font-family: 'Raleway', sans-serif;
      font-size: 0.95em;
      font-weight: 400;
      color: #333;
      text-decoration: none;
      letter-spacing: 1px;
      padding: 5px 0;
      border-bottom: 1px solid transparent;
      transition: border-color 0.3s;
    }
    
    .site-nav a:hover,
    .site-nav a.active {
      border-bottom: 2px solid #F5A623;
    }
    
    /* Mobile top bar */
    .mobile-top-bar {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 60px;
      background: #faf9f7;
      z-index: 1001;
      border-bottom: 1px solid #eee;
    }
    
    .mobile-top-bar-title {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-family: 'Bodoni Moda', serif;
      font-size: 1.5em;
      font-weight: 400;
      letter-spacing: 1px;
      color: #333;
    }
    
    /* Scrollable content wrapper - works on both desktop and mobile */
    .scroll-container {
      position: fixed;
      top: 220px; /* Height of desktop fixed header */
      left: 0;
      right: 0;
      bottom: 0;
      overflow-y: auto;
      overflow-x: hidden;
      background: #faf9f7;
    }
    
    /* Mobile hamburger button */
    .hamburger {
      display: none;
      position: absolute;
      top: 50%;
      left: 15px;
      transform: translateY(-50%);
      z-index: 1002;
      background: none;
      border: none;
      cursor: pointer;
      padding: 10px;
    }
    
    .hamburger span {
      display: block;
      width: 25px;
      height: 2px;
      background: #333;
      margin: 5px 0;
      transition: all 0.3s;
    }
    
    .hamburger.active span:nth-child(1) {
      transform: rotate(45deg) translate(5px, 5px);
    }
    
    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }
    
    .hamburger.active span:nth-child(3) {
      transform: rotate(-45deg) translate(5px, -5px);
    }
    
    /* Mobile menu overlay */
    .mobile-menu {
      display: none;
      position: fixed;
      top: 60px;
      left: 0;
      width: 100%;
      height: calc(100% - 60px);
      background: #faf9f7;
      z-index: 1000;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }
    
    .mobile-menu.active {
      opacity: 1;
      visibility: visible;
    }
    
    .mobile-menu-header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    .mobile-menu-title {
      font-family: 'Raleway', sans-serif;
      font-size: 0.9em;
      font-weight: 500;
      letter-spacing: 3px;
      text-transform: uppercase;
      color: #333;
      margin-bottom: 30px;
    }
    
    .mobile-menu-couple {
      font-family: 'Bodoni Moda', serif;
      font-size: 2.5em;
      font-weight: 400;
      color: #1a1a1a;
      line-height: 1.3;
    }
    
    .mobile-menu-couple .ampersand {
      font-style: normal;
    }
    
    .mobile-menu-date {
      font-family: 'Raleway', sans-serif;
      font-size: 0.85em;
      font-weight: 400;
      letter-spacing: 2px;
      text-transform: uppercase;
      color: #333;
      margin-top: 15px;
    }
    
    .mobile-menu nav {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 25px;
    }
    
    .mobile-menu nav a {
      font-family: 'Raleway', sans-serif;
      font-size: 1.1em;
      font-weight: 400;
      color: #333;
      text-decoration: none;
      letter-spacing: 1px;
    }
    
    /* Page sections */
    .page-section {
      display: none;
      padding: 60px 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .page-section.active {
      display: block;
    }
    
    .page-section h2 {
      font-family: 'Bodoni Moda', serif;
      font-size: 2.5em;
      font-weight: 400;
      color: #1a1a1a;
      text-align: center;
      margin-bottom: 40px;
    }
    
    .page-section p {
      font-family: 'Raleway', sans-serif;
      font-size: 1.1em;
      line-height: 1.8;
      color: #444;
      max-width: 800px;
      margin: 0 auto 20px;
    }
    
    /* Photo grid */
    .photo-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-top: 40px;
    }
    
    .photo-grid img {
      width: 100%;
      height: 300px;
      object-fit: cover;
    }
    
    /* Mobile responsive */
    @media (max-width: 768px) {
      .site-nav {
        display: none;
      }
      
      .mobile-top-bar {
        display: block;
      }
      
      .hamburger {
        display: block;
      }
      
      .mobile-menu {
        display: flex;
      }
      
      .site-title {
        font-size: 3em;
      }
      
      .site-header {
        padding: 15px 20px 30px; /* Reduced top padding since scroll container handles offset */
      }
      
      .photo-grid {
        grid-template-columns: 1fr;
      }
      
      .photo-grid img {
        height: 250px;
      }
      
      .page-section h2 {
        font-size: 1.8em;
      }
      
      /* Mobile: scroll container starts below mobile top bar */
      .scroll-container {
        top: 60px;
        -webkit-overflow-scrolling: touch;
      }
      
      /* Hide desktop fixed header on mobile */
      .desktop-fixed-header {
        display: none;
      }
      
      /* Show mobile-only elements on mobile */
      .mobile-only {
        display: block;
      }
    }
    
    .section {
      margin-bottom: 40px;
    }
    
    .section h2 {
      color: #667eea;
      margin-bottom: 20px;
      font-size: 1.8em;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 10px;
    }
    
    .section p, .section li {
      color: #555;
      line-height: 1.8;
      font-size: 1.05em;
    }
    
    .venue-info {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 15px;
    }
    
    .schedule-item {
      background: #f9f9f9;
      padding: 15px 20px;
      border-radius: 10px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .schedule-item .time {
      font-weight: bold;
      color: #667eea;
      min-width: 100px;
    }
    
    .schedule-item .event {
      flex: 1;
      font-weight: bold;
      color: #333;
    }
    
    .schedule-item .location {
      color: #888;
      font-style: italic;
    }
    
    .accommodation-item, .registry-item {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 15px;
    }
    
    .accommodation-item h3, .registry-item h3 {
      color: #333;
      margin-bottom: 10px;
    }
    
    .accommodation-item a, .registry-item a {
      color: #667eea;
      text-decoration: none;
      font-weight: bold;
    }
    
    .accommodation-item a:hover, .registry-item a:hover {
      text-decoration: underline;
    }
    
    .code {
      background: #faf9f7;
      padding: 5px 10px;
      border-radius: 5px;
      font-family: monospace;
      color: #e74c3c;
      font-weight: bold;
    }
    
    @media (max-width: 600px) {
      .password-page, .main-content {
        padding: 40px 20px;
      }
      
      .header h1 {
        font-size: 2em;
      }
      
      .schedule-item {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .schedule-item .time {
        margin-bottom: 5px;
      }
    }
    
    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <!-- Video Background (only visible on password page) -->
  <div class="video-background">
    <video autoplay muted loop playsinline preload="auto">
      <source src="disco-ball.mp4" type="video/mp4">
    </video>
  </div>
  
  <!-- Password Page -->
  <div class="container">
    <div id="passwordPage" class="password-page">
      <div class="password-input-container">
        <input 
          type="text" 
          id="passwordInput" 
          class="password-input"
          placeholder="Enter password (v43)"
          oninput="checkPasswordAsYouType()"
          onkeydown="if(event.key === 'Enter') { event.preventDefault(); event.stopPropagation(); return false; }"
        />
      </div>
      <div id="errorMessage" class="error-message"></div>
    </div>
    
    <!-- Main Content (hidden until password correct) -->
    <div id="mainContent" class="main-content">
      <!-- Content will be dynamically loaded here after decryption -->
    </div>
  </div>

  <script>
    // Mobile: Lock heights to pixels to prevent shift when keyboard opens
    (function() {
      const isMobile = window.innerWidth <= 768;
      if (isMobile) {
        const initialHeight = window.innerHeight;
        const video = document.querySelector('.video-background');
        const videoEl = document.querySelector('.video-background video');
        
        // Lock video to initial height
        if (video) video.style.height = initialHeight + 'px';
        if (videoEl) videoEl.style.height = initialHeight + 'px';
        
        // Lock body padding-top to pixels (was calc(58vh - 50px))
        document.body.style.paddingTop = (initialHeight * 0.58 - 50) + 'px';
      }
    })();
    
    // Encrypted wedding content (generated by build.js)
    const ENCRYPTED_DATA = '{"salt":"017470f5926f602d09bf55de71d91185","iv":"90143be50bc4c2930d7667397c643fc2","authTag":"7b277019b877f7751dbdb8dc27b8329b","content":"91d6cc6f859d81ae530e37be2d65e0212f75ec41a5ed08cb727167aa4d6c9637cb9d403d82c92ff04a98d30a01c3d37af503906f2a5c6863e12d65ee15bd6830876451d8b734eb55cba30e3bef5eb36b5cd86b4b1b77a5a695b9cc525fd45b423ee5fb85226f817ead4ab754c82feed862c9ebf87cf4f60383ff01cdb1ee7a273ea3448b915e371ba074aedef8f512db685394da6c6d4264d24c1d1a0ef74aef352b1619168e1abfd11c3810058725d29be9005b469c3918f7d56ef55be40dd4f75bdc7c072b827afc1d88e0051baf0816e762e2cc12a426d144f4b3654d8c745de76dba58ab2e851c40257a51d7063173b72365cfd1216baaf8be2c8c3427a020d3d5f3f90d309025549da682dc180f0274b2587523e0188a147918d8debd6fe8e01003fb7f10dfc46af91a39da6e85bc24492d53f2b06f500d1711b2e0b407d022e1137153312731941116953f2822b03ea2b5d574b35a83d3b5009e176ad67f12e1bef7abf2ea02c7816fe93848ed6bd0f1cc05446bf8b088e089e1c4b41d3a6cc167ed8f52ddabce49a9aa169efe39e3492ee7d45d36bd76dea0dc60970b0dae96aae748af6592e0a1fe71e3d88cf09cc94aefdb2291ea51287c1b6d45db3d2b47989cbc00be76a2fa005e869e8c21a2bbd7a45681561ba704b18848e63859d0fe0123f0c94562980b3457e95da64cd245c10fd91ff8cd86800cb269f86b514ad94debd1c526e30722eebe67b1ef77b2a0843ebdc914ea9e914fba172600b6ae201cfaa2ad719414f408519d59db2cff8357a62a2d94bacc12c1d040637e1dea784d8211cc5cdfb956edd255b64c7c94c65b842389c06d3a4f04357b54c1847ffb766589b346859b50f16c7381d0255a230f4f4b2c3c6cb2ae10acb57c221c67a21400f2f278cc4503a5c9c671b92c28f72d9e330306c87bd3cc1fc199ad57c769a567f9c49ed123159178310ad3259199e69d8512c69e5327ff3953145b071361189391caa38bb846cdd86dc630e28663f9f960dec6e8c1cda6ae700010445f8dcc253cdce4bf80ef4f4586523d3192d56f89bae754627e269d288e83330967b6d03056bf471bdfb5964676b8d8fb7146e536aa71964d0a0be80d26c754f8c813ca4d15d9d75257e71bccdcd6e06570d3f6dad2ca41aaf48c72f7a065bbfd92c0dbc3f44c8aae4155e8ecbe7fdeeae0931446bd22eec6600ca918990e9ab6dbd7bb4c1ccec34b306f7798be95fd3f67e4327881e9a1b88385ee69f2f4d87ef40f6cc755f48efe6095029760154426c96edb4664e08c38d2a588e488466aec1b9cb33b75c86e9643ecd6d6f370ee0f0faa4576ea5e4fc9d2a5083388111683b73d7702e6fe3b07430e01f8ff13453501b5e2f850141a5ac13b948b9bad8cb07e99f1d5234bc0f09ceb9db6696aa2274ad027c7f525832711942a820a19e5848a2952b1cdf702fef537f310603d1a116c417d68843fdcec59460adcf3ddd0acd466cb20a72810c2d9af2bca25dbcc35095cbf9c9c15b0d7f8485dc8952fd2c3869955484426c01d9e58eef4baabdffbb94e6d998a9edb0e728ec7c7446fd7386fab89a27b47dbf8f580d99df807814ee8809dfa8925e18f54ef61000fe46269dbd1242c4c2ec2c0a028a9418a10551f195da3b226711e2a520b1c45721ae4c225e65c0a5454969290f70c132d8d6b08cdf01bf584410bfe7268606b2b75cc96b405841fcbc03d3dfed1feca490948e2fa139db23d4f55da7fb3a3b71e5255c143f4e8ccad5fa5db9dd107c2ed0e884d3c4ad02ba96ed24dd58d3dc79d06f45a15238c51e5f13dbf00019bfda5713d058a47bf252bbe7eafbf2717ad8b3c95a2836315e37c12a6ff0029a0b4aeeee731f26a3a34b995520686899c0066b71be2a91525a3a40add2dd16adbf06806fee7fd498704844f6d20c8c099ba0d0f83393ad2be4d7aaba1690269352a79254af53daf666c238a3b0c4afc986d7aaa2dabe83ceb6a6c35be97757d8d49736035cb930c3ee961e64d3e54494a025cc1244f337bcf36bc6930d62fe33c2142d945227a4afe0f8bbec7a8ec1f265bdd7725d26dbd254ce286a15e22f4c297c2aabe1370ec43d1c3b1feab414dfdb36cbdba28ff287ddd6871df2d04089f231560d9d242512a3ff581584501c2e598aa45a178c26afb429959b85c8bfad300adc39f37aa3a971b8f3a79eaa24d838e647ebbc14259227eb1d6d7c0c78d3e"}';
    
    // Decrypt function using Web Crypto API
    async function decryptContent(password, encryptedPayload) {
      try {
        const { salt, iv, authTag, content } = JSON.parse(encryptedPayload);
        
        // Convert hex strings back to bytes
        const saltBytes = hexToBytes(salt);
        const ivBytes = hexToBytes(iv);
        const authTagBytes = hexToBytes(authTag);
        const contentBytes = hexToBytes(content);
        
        // Derive key from password using PBKDF2
        const enc = new TextEncoder();
        const passwordKey = await crypto.subtle.importKey(
          'raw',
          enc.encode(password),
          'PBKDF2',
          false,
          ['deriveBits']
        );
        
        const derivedBits = await crypto.subtle.deriveBits(
          {
            name: 'PBKDF2',
            salt: saltBytes,
            iterations: 100000,
            hash: 'SHA-256'
          },
          passwordKey,
          256
        );
        
        const key = await crypto.subtle.importKey(
          'raw',
          derivedBits,
          'AES-GCM',
          false,
          ['decrypt']
        );
        
        // Combine content and auth tag for GCM
        const combined = new Uint8Array(contentBytes.length + authTagBytes.length);
        combined.set(contentBytes);
        combined.set(authTagBytes, contentBytes.length);
        
        // Decrypt
        const decrypted = await crypto.subtle.decrypt(
          {
            name: 'AES-GCM',
            iv: ivBytes,
            tagLength: 128
          },
          key,
          combined
        );
        
        const dec = new TextDecoder();
        return dec.decode(decrypted);
      } catch (error) {
        return null;
      }
    }
    
    function hexToBytes(hex) {
      const bytes = new Uint8Array(hex.length / 2);
      for (let i = 0; i < hex.length; i += 2) {
        bytes[i / 2] = parseInt(hex.substr(i, 2), 16);
      }
      return bytes;
    }
    
    // Debounce timer for auto-checking password as user types
    let passwordCheckTimer = null;
    
    async function checkPasswordAsYouType() {
      const errorMsg = document.getElementById('errorMessage');
      errorMsg.textContent = ''; // Clear error message while typing
      
      // Clear previous timer
      if (passwordCheckTimer) {
        clearTimeout(passwordCheckTimer);
      }
      
      // Wait 300ms after user stops typing before checking
      passwordCheckTimer = setTimeout(async () => {
        await checkPassword();
      }, 300);
    }
    
    async function checkPassword() {
      const passwordInput = document.getElementById('passwordInput');
      const password = passwordInput.value;
      const errorMsg = document.getElementById('errorMessage');
      
      // Don't check if input is disabled (already granted access)
      if (passwordInput.disabled) {
        return;
      }
      
      if (!password) {
        return;
      }
      
      const decryptedContent = await decryptContent(password, ENCRYPTED_DATA);
      
      if (decryptedContent) {
        // Success! Show "Access Granted" in green
        const passwordInput = document.getElementById('passwordInput');
        passwordInput.type = 'text';
        passwordInput.value = 'Access Granted';
        passwordInput.classList.add('granted');
        passwordInput.disabled = true;
        
        // Close keyboard and scroll back to top first
        passwordInput.blur();
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        // Wait for keyboard to close and scroll to complete, then fade
        setTimeout(async () => {
          try {
            const data = JSON.parse(decryptedContent);
            displayContent(data);
            
            // Hide password page
            document.getElementById('passwordPage').classList.add('hidden');
            
            // Reset mobile-specific styles before showing content
            document.body.style.minHeight = '';
            document.body.style.paddingBottom = '';
            document.body.style.paddingTop = '';
            document.body.style.overflow = '';
            window.scrollTo(0, 0);
            
            // Trigger fade transitions for background
            document.body.classList.add('content-visible');
            document.querySelector('.container').classList.add('content-showing');
            
            // Show main content (but keep it transparent first)
            const mainContent = document.getElementById('mainContent');
            mainContent.style.display = 'block';
            mainContent.style.opacity = '0';
            
            // Force reflow to ensure initial state is applied
            void mainContent.offsetWidth;
            
            // Now fade in the content
            setTimeout(() => {
              mainContent.style.opacity = '1';
            }, 100);
            
            // Store success in session (not password)
            sessionStorage.setItem('authenticated', 'true');
          } catch (error) {
            errorMsg.textContent = 'Error loading content';
          }
        }, 800);
      } else {
        // Only show error if password seems substantial (likely complete)
        // But don't show error if input is already disabled (access granted)
        if (password.length >= 8 && !passwordInput.disabled) {
          errorMsg.textContent = 'Incorrect password';
          // Clear after showing error briefly
          setTimeout(() => {
            document.getElementById('passwordInput').value = '';
            errorMsg.textContent = '';
            document.getElementById('passwordInput').focus();
          }, 1500);
        }
      }
    }
    
    function displayContent(data) {
      const content = document.getElementById('mainContent');
      
      content.innerHTML = `
        <!-- Desktop Fixed Header (names, date, nav) -->
        <div class="desktop-fixed-header">
          <header class="site-header">
            <h1 class="site-title">MEGHAN <span class="ampersand">&</span> NOLAN</h1>
            <p class="site-date">December 31, 2026 <span style="color: #F5A623;">âœ¦</span> Boston, Massachusetts</p>
          </header>
          <nav class="site-nav">
            <a href="#" onclick="showSection('home')" class="active">Home</a>
            <a href="#" onclick="showSection('photos')">Photos</a>
            <a href="#" onclick="showSection('qa')">Q + A</a>
            <a href="#" onclick="showSection('travel')">Travel</a>
            <a href="#" onclick="showSection('things')">Things to Do</a>
            <a href="#" onclick="showSection('registry')">Our Registry</a>
          </nav>
        </div>
        
        <!-- Mobile Top Bar -->
        <div class="mobile-top-bar">
          <button class="hamburger" onclick="toggleMobileMenu()">
            <span></span>
            <span></span>
            <span></span>
          </button>
          <span class="mobile-top-bar-title" id="mobilePageTitle">M & N</span>
        </div>
        
        <!-- Mobile Menu Overlay -->
        <div class="mobile-menu" id="mobileMenu">
          <nav>
            <a href="#" onclick="showSection('home')">Home</a>
            <a href="#" onclick="showSection('photos')">Photos</a>
            <a href="#" onclick="showSection('qa')">Q + A</a>
            <a href="#" onclick="showSection('travel')">Travel</a>
            <a href="#" onclick="showSection('things')">Things to Do</a>
            <a href="#" onclick="showSection('registry')">Our Registry</a>
          </nav>
        </div>
        
        <!-- Scrollable content container -->
        <div class="scroll-container">
          <!-- Mobile header (shows on mobile only) -->
          <header class="site-header mobile-only">
            <h1 class="site-title">MEGHAN <span class="ampersand">&</span> NOLAN</h1>
            <div class="site-date-mobile">
              <span class="date-line">December 31, 2026</span>
              <span class="date-divider"></span>
              <span class="location-line">Boston, Massachusetts</span>
            </div>
          </header>
          
          <!-- Home Section -->
          <section class="page-section active" id="section-home">
            <h2>Welcome</h2>
            <p>We are so excited to celebrate our wedding with you! Please explore this site for all the details about our special day.</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
            <p>Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
            <p>Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet.</p>
            <p>At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati cupiditate non provident.</p>
          </section>
          
          <!-- Photos Section -->
          <section class="page-section" id="section-photos">
            <h2>Photos</h2>
            <p>A collection of our favorite moments together.</p>
            <div class="photo-grid">
              <!-- Photos will go here -->
            </div>
          </section>
          
          <!-- Q+A Section -->
          <section class="page-section" id="section-qa">
            <h2>Q + A</h2>
            <p>Answers to frequently asked questions about our wedding.</p>
          </section>
          
          <!-- Travel Section -->
          <section class="page-section" id="section-travel">
            <h2>Travel</h2>
            <p>Information about getting to Nantucket and where to stay.</p>
          </section>
          
          <!-- Things to Do Section -->
          <section class="page-section" id="section-things">
            <h2>Things to Do</h2>
            <p>Our favorite spots and activities on the island.</p>
          </section>
          
          <!-- Registry Section -->
          <section class="page-section" id="section-registry">
            <h2>Our Registry</h2>
            <p>Thank you for thinking of us!</p>
          </section>
        </div>
      `;
    }
    
    function toggleMobileMenu() {
      const menu = document.getElementById('mobileMenu');
      const hamburger = document.querySelector('.hamburger');
      menu.classList.toggle('active');
      hamburger.classList.toggle('active');
    }
    
    function showSection(sectionId) {
      // Section title mapping
      const titles = {
        'home': 'M & N',
        'photos': 'Photos',
        'qa': 'Q + A',
        'travel': 'Travel',
        'things': 'Things to Do',
        'registry': 'Our Registry'
      };
      
      // Hide all sections
      document.querySelectorAll('.page-section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Show selected section
      const section = document.getElementById('section-' + sectionId);
      if (section) section.classList.add('active');
      
      // Update nav active state
      document.querySelectorAll('.site-nav a').forEach(link => {
        link.classList.remove('active');
      });
      event.target.classList.add('active');
      
      // Update mobile top bar title
      const mobileTitle = document.getElementById('mobilePageTitle');
      if (mobileTitle && titles[sectionId]) {
        mobileTitle.textContent = titles[sectionId];
      }
      
      // Close mobile menu if open
      const menu = document.getElementById('mobileMenu');
      const hamburger = document.querySelector('.hamburger');
      if (menu) menu.classList.remove('active');
      if (hamburger) hamburger.classList.remove('active');
      
      return false;
    }
    
    // Mobile: scroll page up when keyboard opens so input is visible
    if (window.innerWidth <= 768) {
      document.getElementById('passwordInput').addEventListener('focus', function() {
        // Wait for keyboard to fully open, then scroll up
        setTimeout(() => {
          // Scroll enough to move content above keyboard (keyboards are ~40-50% of screen)
          const scrollAmount = window.innerHeight * 0.25;
          window.scrollTo({ top: scrollAmount, behavior: 'smooth' });
        }, 400);
      });
    }
  </script>
</body>
</html>

